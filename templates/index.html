{% extends "base.html" %}
{% block title %}Acceso{% endblock %}

{% block content %}
<style>
  :root{
    --bg1:#0f172a;
    --bg2:#1e293b;
    --card: rgba(255,255,255,.08);
    --card2: rgba(255,255,255,.12);
    --text: #e2e8f0;
    --muted:#94a3b8;
    --border: rgba(255,255,255,.16);
    --accent:#38bdf8;
    --accent2:#a78bfa;
    --danger:#fb7185;
  }

  body{
    margin:0;
    min-height:100vh;
    color:var(--text);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue";
    background:
      radial-gradient(1200px 600px at 20% 10%, rgba(56,189,248,.25), transparent 60%),
      radial-gradient(900px 500px at 80% 20%, rgba(167,139,250,.22), transparent 60%),
      linear-gradient(160deg, var(--bg1), var(--bg2));
  }

  .auth-wrap{
    max-width: 980px;
    margin: 48px auto;
    padding: 0 16px;
    display:grid;
    grid-template-columns: 1.1fr 1fr;
    gap: 18px;
    align-items: stretch;
  }

  @media (max-width: 900px){
    .auth-wrap{ grid-template-columns: 1fr; margin: 24px auto; }
  }

  .hero{
    border: 1px solid var(--border);
    background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
    border-radius: 22px;
    padding: 26px;
    box-shadow: 0 20px 60px rgba(0,0,0,.35);
    overflow:hidden;
    position:relative;
  }
  .hero::after{
    content:"";
    position:absolute; inset:-120px -120px auto auto;
    width:260px; height:260px;
    background: radial-gradient(circle, rgba(56,189,248,.35), transparent 60%);
    filter: blur(6px);
    transform: rotate(25deg);
  }
  .hero h1{ margin:0 0 10px 0; font-size: 34px; letter-spacing: .2px; }
  .hero p{ margin:0 0 18px 0; color: var(--muted); line-height: 1.5; }
  .pill-row{ display:flex; flex-wrap:wrap; gap:10px; margin-top:14px;}
  .pill{
    font-size: 13px;
    padding: 8px 10px;
    border-radius: 999px;
    border: 1px solid var(--border);
    background: rgba(255,255,255,.06);
  }

  .card{
    border: 1px solid var(--border);
    background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
    border-radius: 22px;
    padding: 18px;
    box-shadow: 0 20px 60px rgba(0,0,0,.35);
  }

  .tabs{
    display:flex;
    gap:8px;
    padding: 6px;
    border: 1px solid var(--border);
    background: rgba(255,255,255,.05);
    border-radius: 16px;
    margin-bottom: 14px;
  }
  .tab-btn{
    flex:1;
    border: 0;
    cursor:pointer;
    padding: 10px 12px;
    border-radius: 12px;
    background: transparent;
    color: var(--muted);
    font-weight: 600;
    transition: .15s ease;
  }
  .tab-btn.active{
    background: rgba(255,255,255,.12);
    color: var(--text);
    box-shadow: inset 0 0 0 1px rgba(255,255,255,.14);
  }

  .panel{ display:none; }
  .panel.active{ display:block; animation: fadeIn .18s ease-out; }
  @keyframes fadeIn{ from{opacity:.6; transform: translateY(2px);} to{opacity:1; transform:none;} }

  .field{ margin: 10px 0; }
  .label{ display:block; font-size: 13px; color: var(--muted); margin-bottom: 6px; }
  .input{
    width:100%;
    box-sizing:border-box;
    padding: 12px 12px;
    border-radius: 14px;
    border: 1px solid rgba(255,255,255,.18);
    background: rgba(2,6,23,.35);
    color: var(--text);
    outline: none;
    transition: .15s ease;
  }
  .input:focus{
    border-color: rgba(56,189,248,.55);
    box-shadow: 0 0 0 4px rgba(56,189,248,.12);
  }

  .pw-wrap{ position:relative; }
  .eye-btn{
    position:absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    border: 0;
    background: rgba(255,255,255,.08);
    color: var(--text);
    padding: 8px 10px;
    border-radius: 12px;
    cursor:pointer;
    line-height: 1;
    transition: .15s ease;
  }
  .eye-btn:hover{ background: rgba(255,255,255,.12); }
  .eye-btn:active{ transform: translateY(-50%) scale(.98); }

  .row{ display:flex; gap:10px; }
  .row .field{ flex:1; }
  @media (max-width: 520px){ .row{ flex-direction:column; } }

  .actions{ display:flex; gap:10px; margin-top: 12px; align-items:center; }
  .btn{
    width:100%;
    padding: 12px 14px;
    border-radius: 14px;
    border: 1px solid rgba(255,255,255,.18);
    background: linear-gradient(135deg, rgba(56,189,248,.35), rgba(167,139,250,.28));
    color: var(--text);
    font-weight: 700;
    cursor:pointer;
    transition:.15s ease;
  }
  .btn:hover{ filter: brightness(1.08); }
  .btn:active{ transform: translateY(1px); }

  .hint{ margin-top: 10px; color: var(--muted); font-size: 13px; line-height: 1.4; }

  /* flashes del base.html: si quieres que queden bonitos */
  .flash-box{
    border: 1px solid rgba(255,255,255,.18);
    background: rgba(2,6,23,.35);
    border-radius: 16px;
    padding: 12px 14px;
    margin: 12px 0 18px 0;
  }
</style>

<div class="auth-wrap">
  <section class="hero">
    <h1>Bienvenido üëã</h1>
    <p>
      Entra con tu cuenta para acceder al juego y a tus publicaciones.
      Tus sesiones van protegidas con cookies seguras y CSRF.
    </p>
    <div class="pill-row">
      <span class="pill">‚úÖ Login seguro</span>
      <span class="pill">üîí CSRF</span>
      <span class="pill">üóÉÔ∏è SQLite</span>
      <span class="pill">‚ö° R√°pido</span>
    </div>
    <p class="hint" style="margin-top:18px;">
      Tip: usa una contrase√±a fuerte (m√≠nimo 10). Puedes pulsar el ojo para verla.
    </p>
  </section>

  <section class="card">
    <div class="tabs" role="tablist" aria-label="Acceso">
      <button class="tab-btn active" type="button" data-tab="login">Iniciar sesi√≥n</button>
      <button class="tab-btn" type="button" data-tab="register">Crear cuenta</button>
    </div>

    <!-- LOGIN -->
    <div class="panel active" id="panel-login">
      <form method="POST" action="{{ url_for('login') }}">
        {{ login_form.hidden_tag() }}

        <div class="field">
          <label class="label">Email</label>
          {{ login_form.email(class_="input", placeholder="tu@email.com") }}
        </div>

        <div class="field">
          <label class="label">Contrase√±a</label>
          <div class="pw-wrap">
            {{ login_form.password(class_="input", placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢", id="login-password") }}
            <button class="eye-btn" type="button" data-toggle="login-password" aria-label="Mostrar contrase√±a">
              üëÅ
            </button>
          </div>
        </div>

        <div class="actions">
          <button class="btn" type="submit">Entrar</button>
        </div>

        <div class="hint">
          ¬øNo tienes cuenta? Cambia a ‚ÄúCrear cuenta‚Äù.
        </div>
      </form>
    </div>

    <!-- REGISTER -->
    <div class="panel" id="panel-register">
      <form method="POST" action="{{ url_for('register') }}">
        {{ register_form.hidden_tag() }}

        <div class="field">
          <label class="label">Email</label>
          {{ register_form.email(class_="input", placeholder="tu@email.com") }}
        </div>

        <div class="field">
          <label class="label">Nombre (opcional)</label>
          {{ register_form.username(class_="input", placeholder="Pepe") }}
        </div>

        <div class="row">
          <div class="field">
            <label class="label">Contrase√±a (m√≠n. 10)</label>
            <div class="pw-wrap">
              {{ register_form.password(class_="input", placeholder="m√≠nimo 10 caracteres", id="reg-password") }}
              <button class="eye-btn" type="button" data-toggle="reg-password" aria-label="Mostrar contrase√±a">
                üëÅ
              </button>
            </div>
          </div>
          <div class="field">
            <label class="label">Repite contrase√±a</label>
            <div class="pw-wrap">
              {{ register_form.password2(class_="input", placeholder="repite la contrase√±a", id="reg-password2") }}
              <button class="eye-btn" type="button" data-toggle="reg-password2" aria-label="Mostrar contrase√±a">
                üëÅ
              </button>
            </div>
          </div>
        </div>

        <div class="actions">
          <button class="btn" type="submit">Registrar</button>
        </div>

        <div class="hint">
          Al registrarte aceptas que guardemos tu email y una contrase√±a hasheada (nunca en texto plano).
        </div>
      </form>
    </div>
  </section>
</div>

<script>
  // Tabs
  const tabButtons = document.querySelectorAll('.tab-btn');
  const panels = {
    login: document.getElementById('panel-login'),
    register: document.getElementById('panel-register'),
  };

  tabButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      tabButtons.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      const tab = btn.dataset.tab;
      panels.login.classList.toggle('active', tab === 'login');
      panels.register.classList.toggle('active', tab === 'register');
    });
  });

  // Ojo: mostrar/ocultar contrase√±a
  document.querySelectorAll('[data-toggle]').forEach(btn => {
    btn.addEventListener('click', () => {
      const inputId = btn.getAttribute('data-toggle');
      const input = document.getElementById(inputId);
      if (!input) return;

      const isPassword = input.getAttribute('type') === 'password';
      input.setAttribute('type', isPassword ? 'text' : 'password');
      btn.textContent = isPassword ? 'üôà' : 'üëÅ';
    });
  });
</script>
{% endblock %}
